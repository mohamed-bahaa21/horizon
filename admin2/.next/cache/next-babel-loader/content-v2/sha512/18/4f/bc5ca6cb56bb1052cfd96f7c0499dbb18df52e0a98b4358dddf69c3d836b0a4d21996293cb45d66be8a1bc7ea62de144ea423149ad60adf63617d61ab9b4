{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useMemo } from 'react';\nimport classNames from 'classnames';\nimport PageviewsChart from './PageviewsChart';\nimport MetricsBar from './MetricsBar';\nimport WebsiteHeader from './WebsiteHeader';\nimport DateFilter from 'components/common/DateFilter';\nimport StickyHeader from 'components/helpers/StickyHeader';\nimport Button from 'components/common/Button';\nimport useFetch from 'hooks/useFetch';\nimport useDateRange from 'hooks/useDateRange';\nimport useTimezone from 'hooks/useTimezone';\nimport usePageQuery from 'hooks/usePageQuery';\nimport { getDateArray, getDateLength } from 'lib/date';\nimport Times from 'assets/times.svg';\nimport styles from './WebsiteChart.module.css';\nimport ErrorMessage from '../common/ErrorMessage';\nimport useShareToken from '../../hooks/useShareToken';\nimport { TOKEN_HEADER } from '../../lib/constants';\nexport default function WebsiteChart({\n  websiteId,\n  title,\n  domain,\n  stickyHeader = false,\n  showLink = false,\n  hideChart = false,\n  onDataLoad = () => {}\n}) {\n  const shareToken = useShareToken();\n  const [dateRange, setDateRange] = useDateRange(websiteId);\n  const {\n    startDate,\n    endDate,\n    unit,\n    value,\n    modified\n  } = dateRange;\n  const [timezone] = useTimezone();\n  const {\n    router,\n    resolve,\n    query: {\n      url\n    }\n  } = usePageQuery();\n  const {\n    data,\n    loading,\n    error\n  } = useFetch(`/api/website/${websiteId}/pageviews`, {\n    params: {\n      start_at: +startDate,\n      end_at: +endDate,\n      unit,\n      tz: timezone,\n      url\n    },\n    onDataLoad,\n    headers: {\n      [TOKEN_HEADER]: shareToken === null || shareToken === void 0 ? void 0 : shareToken.token\n    }\n  }, [url, modified]);\n  const chartData = useMemo(() => {\n    if (data) {\n      return {\n        pageviews: getDateArray(data.pageviews, startDate, endDate, unit),\n        sessions: getDateArray(data.sessions, startDate, endDate, unit)\n      };\n    }\n\n    return {\n      pageviews: [],\n      sessions: []\n    };\n  }, [data]);\n\n  function handleCloseFilter() {\n    router.push(resolve({\n      url: undefined\n    }));\n  }\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: styles.container,\n    children: [/*#__PURE__*/_jsx(WebsiteHeader, {\n      websiteId: websiteId,\n      title: title,\n      domain: domain,\n      showLink: showLink\n    }), /*#__PURE__*/_jsx(\"div\", {\n      className: classNames(styles.header, 'row'),\n      children: /*#__PURE__*/_jsxs(StickyHeader, {\n        className: classNames(styles.metrics, 'col row'),\n        stickyClassName: styles.sticky,\n        enabled: stickyHeader,\n        children: [url && /*#__PURE__*/_jsx(PageFilter, {\n          url: url,\n          onClick: handleCloseFilter\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"col-12 col-lg-9\",\n          children: /*#__PURE__*/_jsx(MetricsBar, {\n            websiteId: websiteId\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: classNames(styles.filter, 'col-12 col-lg-3'),\n          children: /*#__PURE__*/_jsx(DateFilter, {\n            value: value,\n            startDate: startDate,\n            endDate: endDate,\n            onChange: setDateRange\n          })\n        })]\n      })\n    }), /*#__PURE__*/_jsx(\"div\", {\n      className: \"row\",\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        className: \"col\",\n        children: [error && /*#__PURE__*/_jsx(ErrorMessage, {}), !hideChart && /*#__PURE__*/_jsx(PageviewsChart, {\n          websiteId: websiteId,\n          data: chartData,\n          unit: unit,\n          records: getDateLength(startDate, endDate, unit),\n          loading: loading\n        })]\n      })\n    })]\n  });\n}\n\nconst PageFilter = ({\n  url,\n  onClick\n}) => {\n  return /*#__PURE__*/_jsx(\"div\", {\n    className: classNames(styles.url, 'col-12'),\n    children: /*#__PURE__*/_jsx(Button, {\n      icon: /*#__PURE__*/_jsx(Times, {}),\n      onClick: onClick,\n      variant: \"action\",\n      iconRight: true,\n      children: url\n    })\n  });\n};","map":null,"metadata":{},"sourceType":"module"}